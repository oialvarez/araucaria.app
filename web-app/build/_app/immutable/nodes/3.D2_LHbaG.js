import{r as G,s as J,n as D,o as ne}from"../chunks/B2QSKqcC.js";import{a as K,S as Q,i as W,d as m,o as R,b,c as y,p as P,q as ae,e as T,f as v,g as E,j as C,h as j,k as w,s as A,l as X,m as Y,n as Z,r as se,t as le,u as re,v as oe,w as B,x as ie}from"../chunks/DUA33kkY.js";import{a as ee,e as ce,f as te,b as I,d as ue,u as fe,q as de,w as he,o as pe}from"../chunks/DE09AEA1.js";import{o as me}from"../chunks/BvtAnBkQ.js";function F(l){return(l==null?void 0:l.length)!==void 0?l:Array.from(l)}function _e(l,e){l.d(1),e.delete(l.key)}function ge(l,e,t,n,o,u,s,c,f,d,r,a){let i=l.length,h=u.length,k=i;const q={};for(;k--;)q[l[k].key]=k;const M=[],S=new Map,U=new Map,z=[];for(k=h;k--;){const p=a(o,u,k),_=t(p);let g=s.get(_);g?z.push(()=>g.p(p,e)):(g=d(_,p),g.c()),S.set(_,M[k]=g),_ in q&&U.set(_,Math.abs(k-q[_]))}const L=new Set,O=new Set;function x(p){K(p,1),p.m(c,r),s.set(p.key,p),r=p.first,h--}for(;i&&h;){const p=M[h-1],_=l[i-1],g=p.key,N=_.key;p===_?(r=p.first,i--,h--):S.has(N)?!s.has(g)||L.has(g)?x(p):O.has(N)?i--:U.get(g)>U.get(N)?(O.add(g),x(p)):(L.add(N),i--):(f(_,s),i--)}for(;i--;){const p=l[i];S.has(p.key)||f(p,s)}for(;h;)x(M[h-1]);return G(z),M}function H(l){let e,t;return{c(){e=w("p"),t=Z(l[1]),this.h()},l(n){e=v(n,"P",{class:!0});var o=E(e);t=Y(o,l[1]),o.forEach(m),this.h()},h(){T(e,"class","error")},m(n,o){b(n,e,o),y(e,t)},p(n,o){o&2&&X(t,n[1])},d(n){n&&m(e)}}}function ye(l){let e,t,n,o,u,s="Agregar tarea",c,f,d,r=l[1]&&H(l);return{c(){e=w("div"),t=w("form"),n=w("input"),o=A(),u=w("button"),u.textContent=s,c=A(),r&&r.c(),this.h()},l(a){e=v(a,"DIV",{class:!0});var i=E(e);t=v(i,"FORM",{});var h=E(t);n=v(h,"INPUT",{type:!0,placeholder:!0}),o=C(h),u=v(h,"BUTTON",{type:!0,"data-svelte-h":!0}),j(u)!=="svelte-ztzhlv"&&(u.textContent=s),h.forEach(m),c=C(i),r&&r.l(i),i.forEach(m),this.h()},h(){T(n,"type","text"),T(n,"placeholder","Nueva tarea"),n.required=!0,T(u,"type","submit"),T(e,"class","add-tarea")},m(a,i){b(a,e,i),y(e,t),y(t,n),R(n,l[0]),y(t,o),y(t,u),y(e,c),r&&r.m(e,null),f||(d=[P(n,"input",l[4]),P(t,"submit",ae(l[2]))],f=!0)},p(a,[i]){i&1&&n.value!==a[0]&&R(n,a[0]),a[1]?r?r.p(a,i):(r=H(a),r.c(),r.m(e,null)):r&&(r.d(1),r=null)},i:D,o:D,d(a){a&&m(e),r&&r.d(),f=!1,G(d)}}}function ve(l,e,t){let{onTareaAgregada:n}=e,o="",u="";async function s(){t(1,u="");const f=ee.currentUser;if(!f){t(1,u="Debes estar autenticado.");return}if(o.trim()===""){t(1,u="Escribe algo para la tarea.");return}try{await ce(te(I,"tareas"),{text:o,completed:!1,uid:f.uid}),t(0,o=""),n&&n()}catch(d){console.error(d),t(1,u="Error al agregar la tarea.")}}function c(){o=this.value,t(0,o)}return l.$$set=f=>{"onTareaAgregada"in f&&t(3,n=f.onTareaAgregada)},[o,u,s,n,c]}class we extends Q{constructor(e){super(),W(this,e,ve,ye,J,{onTareaAgregada:3})}}function V(l,e,t){const n=l.slice();return n[6]=e[t],n}function be(l){let e,t="No tienes tareas pendientes.";return{c(){e=w("p"),e.textContent=t},l(n){e=v(n,"P",{"data-svelte-h":!0}),j(e)!=="svelte-1x9mc4k"&&(e.textContent=t)},m(n,o){b(n,e,o)},p:D,d(n){n&&m(e)}}}function ke(l){let e,t=[],n=new Map,o=F(l[0]);const u=s=>s[6].id;for(let s=0;s<o.length;s+=1){let c=V(l,o,s),f=u(c);n.set(f,t[s]=$(f,c))}return{c(){e=w("ul");for(let s=0;s<t.length;s+=1)t[s].c()},l(s){e=v(s,"UL",{});var c=E(e);for(let f=0;f<t.length;f+=1)t[f].l(c);c.forEach(m)},m(s,c){b(s,e,c);for(let f=0;f<t.length;f+=1)t[f]&&t[f].m(e,null)},p(s,c){c&5&&(o=F(s[0]),t=ge(t,c,u,1,s,o,n,e,_e,$,null,V))},d(s){s&&m(e);for(let c=0;c<t.length;c+=1)t[c].d()}}}function $(l,e){let t,n,o,u,s=e[6].text+"",c,f,d,r;function a(){return e[4](e[6])}return{key:l,first:null,c(){t=w("li"),n=w("input"),u=A(),c=Z(s),f=A(),this.h()},l(i){t=v(i,"LI",{});var h=E(t);n=v(h,"INPUT",{type:!0}),u=C(h),c=Y(h,s),f=C(h),h.forEach(m),this.h()},h(){T(n,"type","checkbox"),n.checked=o=e[6].completed,this.first=t},m(i,h){b(i,t,h),y(t,n),y(t,u),y(t,c),y(t,f),d||(r=P(n,"change",a),d=!0)},p(i,h){e=i,h&1&&o!==(o=e[6].completed)&&(n.checked=o),h&1&&s!==(s=e[6].text+"")&&X(c,s)},d(i){i&&m(t),d=!1,r()}}}function Te(l){let e,t,n,o="Dashboard - Tareas pendientes",u,s,c;e=new we({props:{onTareaAgregada:l[1]}});function f(a,i){return a[0].length>0?ke:be}let d=f(l),r=d(l);return{c(){ie(e.$$.fragment),t=A(),n=w("h1"),n.textContent=o,u=A(),r.c(),s=B()},l(a){oe(e.$$.fragment,a),t=C(a),n=v(a,"H1",{"data-svelte-h":!0}),j(n)!=="svelte-1o2totm"&&(n.textContent=o),u=C(a),r.l(a),s=B()},m(a,i){re(e,a,i),b(a,t,i),b(a,n,i),b(a,u,i),r.m(a,i),b(a,s,i),c=!0},p(a,[i]){d===(d=f(a))&&r?r.p(a,i):(r.d(1),r=d(a),r&&(r.c(),r.m(s.parentNode,s)))},i(a){c||(K(e.$$.fragment,a),c=!0)},o(a){le(e.$$.fragment,a),c=!1},d(a){a&&(m(t),m(n),m(u),m(s)),se(e,a),r.d(a)}}}function Ce(l,e,t){let n,o=[],u=null;ne(()=>{me(ee,d=>{d?(u=d.uid,s()):u=null})});function s(){if(!u)return;const d=de(te(I,"tareas"),he("uid","==",u));pe(d,r=>{t(3,o=r.docs.map(a=>({id:a.id,...a.data()})))})}async function c(d,r){const a=ue(I,"tareas",d);await fe(a,{completed:!r})}const f=d=>c(d.id,d.completed);return l.$$.update=()=>{l.$$.dirty&8&&t(0,n=o.filter(d=>!d.completed))},[n,s,c,o,f]}class qe extends Q{constructor(e){super(),W(this,e,Ce,Te,J,{})}}export{qe as component};
